{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
    .course-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 25px;
    }

    .course-card {
        border-radius: 18px;
        overflow: hidden;
        background: #ffffff;
        box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
    }

    .course-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 14px 35px rgba(0,0,0,0.15);
    }

    .course-header {
        background: linear-gradient(135deg, #6366f1, #4f46e5);
        color: #fff;
        padding: 18px;
        font-weight: 600;
        font-size: 1.1rem;
    }

    .course-body {
        padding: 18px;
    }

    .course-desc {
        font-size: 0.9rem;
        color: #555;
        min-height: 60px;
    }

    .video-preview video {
        width: 100%;
        border-radius: 12px;
        margin-top: 10px;
    }

    .course-footer {
        padding: 15px;
        text-align: center;
        background: #f9fafb;
    }

    .enroll-btn {
        background: #4f46e5;
        border: none;
        color: #fff;
        border-radius: 30px;
        padding: 8px 25px;
        font-size: 0.9rem;
        transition: background 0.3s ease;
    }

    .enroll-btn:hover {
        background: #4338ca;
        color: #fff;
    }

    .enrolled-badge {
        background: #16a34a;
        color: #fff;
        padding: 8px 18px;
        border-radius: 30px;
        font-size: 0.85rem;
        display: inline-block;
    }

    .page-title {
        font-weight: 700;
        text-align: center;
        margin-bottom: 30px;
    }
</style>

<div class="container mt-4">

    <h2 class="page-title">üìö Available Courses</h2>

    {% if courses %}
        <div class="course-grid">

            {% for course in courses %}
                <div class="course-card">

                    <div class="course-header">
                        {{ course.title }}
                    </div>

                    <div class="course-body">
                        <p class="course-desc">
                            {{ course.description|truncatechars:120 }}
                        </p>

                        {% if course.video %}
                            <div class="video-preview">
                                <video controls>
                                    <source src="{{ course.video.url }}" type="video/mp4">
                                </video>
                            </div>
                        {% endif %}
                    </div>

                    <div class="course-footer">
                        {% if course.id in enrolled_courses %}
                            <span class="enrolled-badge">
                                ‚úî Enrolled
                            </span>
                        {% else %}
                            {% if request.user.is_active %}
    <form method="post"
          action="{% url 'courses:enroll-course' course.id %}">
        {% csrf_token %}
        <button type="submit" class="enroll-btn">
            ‚ûï Enroll Now
        </button>
    </form>
{% else %}
    <span class="badge bg-warning text-dark">
        ‚è≥ Waiting for Admin Approval
    </span>
{% endif %}

                        {% endif %}
                    </div>

                </div>
            {% endfor %}

        </div>
    {% else %}
        <p class="text-center text-muted">
            No courses available
        </p>
    {% endif %}

</div>

{% endblock %}
